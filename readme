# MyApp - Go + PostgreSQL + Docker

á»¨ng dá»¥ng Go vá»›i PostgreSQL cháº¡y trÃªn Docker, Ä‘Æ°á»£c tá»‘i Æ°u cho development trong VS Code.

## ğŸš€ Quick Start

### 1. Setup ban Ä‘áº§u
```bash
# Clone project vÃ  cd vÃ o thÆ° má»¥c
git clone <your-repo>
cd myapp

# Setup mÃ´i trÆ°á»ng (táº¡o .env file)
make setup

# Cáº­p nháº­t .env vá»›i thÃ´ng tin cá»§a báº¡n
nano .env
```

### 2. Khá»Ÿi Ä‘á»™ng services
```bash
# Khá»Ÿi Ä‘á»™ng database vÃ  pgAdmin
make up

# Chá» 10 giÃ¢y Ä‘á»ƒ database khá»Ÿi Ä‘á»™ng hoÃ n tÃ i
sleep 10

# Cháº¡y á»©ng dá»¥ng Go
make run
```

### 3. Kiá»ƒm tra
- **API Health**: http://localhost:8000/health
- **API Readiness**: http://localhost:8000/readiness  
- **Users API**: http://localhost:8000/api/v1/users
- **pgAdmin**: http://localhost:8080 (admin@myapp.com / admin123)

## ğŸ“ Cáº¥u trÃºc project

```
myapp/
â”œâ”€â”€ docker-compose.yml          # Docker services config
â”œâ”€â”€ .env                       # Environment variables (local)
â”œâ”€â”€ .env.example              # Template cho team
â”œâ”€â”€ Makefile                  # Development commands
â”œâ”€â”€ main.go                   # Go application
â”œâ”€â”€ go.mod                    # Go dependencies
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ postgres/
â”‚   â”‚   â”œâ”€â”€ init/            # Database init scripts
â”‚   â”‚   â””â”€â”€ backup/          # Database backups
â”‚   â””â”€â”€ pgadmin/
â”‚       â””â”€â”€ servers.json     # pgAdmin server config
â”œâ”€â”€ .vscode/
â”‚   â””â”€â”€ settings.json        # VS Code settings
â””â”€â”€ .gitignore               # Git ignore rules
```

## ğŸ˜ Database Info

### Connection Details
- **Host**: localhost
- **Port**: 5432  
- **Database**: myapp_db
- **Username**: admin
- **Password**: SecurePass123! (Ä‘á»•i trong .env)

### Default Data
- **Admin User**: admin@myapp.com / admin123
- **Sample Tables**: users, roles, user_roles, audit_logs
- **Extensions**: uuid-ossp, pgcrypto, citext

## ğŸ› ï¸ Development Commands

### Docker & Services
```bash
make up          # Start services  
make down        # Stop services
make restart     # Restart services
make logs        # View all logs
make status      # Show services status
```

### Database
```bash
make db-connect  # Connect to PostgreSQL
make db-backup   # Backup database
make db-restore  # Restore from backup
make db-reset    # Reset database (âš ï¸ destroys data)
```

### Application
```bash
make run         # Run Go app
make build       # Build binary
make test        # Run tests
make dev         # Start full dev environment
```

### Health Checks
```bash
make health      # Check app health
make readiness   # Check app readiness
```

## ğŸ”Œ VS Code Integration

### Required Extensions
- **Docker** (Microsoft)
- **Database Client** (Weijan Chen)
- **Go** (Google)

### Database Connection trong VS Code
1. Má»Ÿ Command Palette (`Ctrl+Shift+P`)
2. GÃµ: "Database Client: New Connection"
3. Chá»n "PostgreSQL"
4. Nháº­p:
   ```
   Host: localhost
   Port: 5432
   Username: admin
   Password: SecurePass123!
   Database: myapp_db
   ```

## ğŸ“Š pgAdmin Web UI

1. Truy cáº­p: http://localhost:8080
2. ÄÄƒng nháº­p: admin@myapp.com / admin123
3. Server sáº½ tá»± Ä‘á»™ng káº¿t ná»‘i vá»›i PostgreSQL

## ğŸ”’ Security Notes

### Development
- Passwords Ä‘Æ°á»£c hardcode trong .env cho development
- SSL disabled cho local development
- Debug mode enabled

### Production  
- [ ] Thay Ä‘á»•i táº¥t cáº£ passwords
- [ ] Enable SSL cho database
- [ ] Set APP_DEBUG=false
- [ ] Use secrets management
- [ ] Configure firewall rules

## ğŸš¨ Troubleshooting

### Database Connection Failed
```bash
# Kiá»ƒm tra containers
docker-compose ps

# Xem logs PostgreSQL  
make logs-db

# Reset database
make db-reset
```

### Port Conflicts
```bash
# Thay Ä‘á»•i ports trong .env
DB_PORT=5433
APP_PORT=8001
PGADMIN_PORT=8081
```

### VS Code Database Client khÃ´ng káº¿t ná»‘i Ä‘Æ°á»£c
1. Äáº£m báº£o Docker containers Ä‘ang cháº¡y: `make status`
2. Test connection: `make db-connect`
3. Restart VS Code
4. Reinstall Database Client extension

## ğŸ“ API Endpoints

### Health Checks
- `GET /health` - Application health status
- `GET /readiness` - Readiness probe (checks DB connection)

### Users API
- `GET /api/v1/users` - List users
- `POST /api/v1/users` - Create user  
- `GET /api/v1/users/:id` - Get user by ID
- `PUT /api/v1/users/:id` - Update user
- `DELETE /api/v1/users/:id` - Delete user

## ğŸ¤ Contributing

1. Copy `.env.example` to `.env` vÃ  cáº­p nháº­t values
2. Cháº¡y `make setup` Ä‘á»ƒ cÃ i Ä‘áº·t dependencies
3. Cháº¡y `make dev` Ä‘á»ƒ start development environment
4. Make changes vÃ  test
5. Submit Pull Request

## ğŸ“ˆ Performance Tuning

### Database Connection Pool
```env
DB_MAX_OPEN_CONNS=25      # Maximum open connections
DB_MAX_IDLE_CONNS=5       # Maximum idle connections  
DB_CONN_MAX_LIFETIME=300s # Connection lifetime
```

### Docker Resources
```yaml
# ThÃªm vÃ o docker-compose.yml náº¿u cáº§n
deploy:
  resources:
    limits:
      memory: 512M
      cpus: '0.5'
```

## ğŸ“ Support

- **Issues**: Create GitHub issue
- **Documentation**: Check this README
- **Database Issues**: Use `make db-connect` to debug
- **Docker Issues**: Use `make logs` to check logs